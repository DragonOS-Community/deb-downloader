# glibc-ubuntu2404 package configuration
# 包列表
PACKAGES=("libc-bin" "libstdc++6")

# Docker标签
DOCKER_TAG="ubuntu2404"

# 输出tar文件名
TAR_NAME="glibc-ubuntu2404.tar.xz"

# 后处理钩子函数 - 为glibc创建必要的符号链接
post_unpack_hook() {
    echo "Creating glibc-specific symlinks..."
    
    # 创建lib符号链接
    if ! ln -sf usr/lib "$SYSROOT_DIR/lib"; then
        echo "Warning: lib symlink creation failed with normal user, retrying with sudo..." >&2
        if ! sudo ln -sf usr/lib "$SYSROOT_DIR/lib"; then
            echo "Error: failed to create lib symlink" >&2
            exit 1
        else
            echo "/usr/lib symlink creation successful with sudo." >&2
        fi
    fi
    
    # 创建lib64符号链接
    if ! ln -sf usr/lib64 "$SYSROOT_DIR/lib64"; then
        if ! sudo ln -sf usr/lib64 "$SYSROOT_DIR/lib64"; then
            echo "Error: failed to create lib64 symlink" >&2
            exit 1
        else
            echo "/usr/lib64 symlink creation successful with sudo." >&2
        fi
    fi
}
